HTTP 是明文传输，HTTPS 是加密传输 HTTPS = HTTP + TLS/SSL

### TSL 中的加密

- 对称加密：两边拥有相同的密钥，两边都知道如何将密文加密解密
- 非对称解密：有公钥和私钥之分，公钥所有人都知道，可以将数据用公钥加密，但是将数据解密必须使用私钥解密，私有只有分发公钥的一方才知道

### 对称密钥加密和非对称密钥加密有什么区别

- 对称密钥加密是最简单的一种加密方式，加解密都是相同的密钥，好处是加解密效率快，但是不安全，如果有人拿到了这个密钥谁都可以进行解密
- 非对称密钥会有两把密钥，一把是私钥，只有自己才有；一把是公钥，可以发布给任何人。并且加密的内容只有相匹配的密钥才能解。这样带来的一个好处就是能保证传输的内容是安全的，因为例如如果是公钥加密的数据，就算是第三方截取了这个数据但是没有对应的私钥也解密不了。缺点是非对称加密的时候要消耗一定的时间，减低了数据的传输效率；因为公钥是公开的，拥有对应公钥的黑客可以用这个公钥进行解密得到里面的信息；公钥中没有包含服务器的信息，所以并不能确保服务器合法的身份

### HTTPS 加密过程

1. 客户端请求网址，例如www.baidu.com
2. 服务端存储着公钥和私钥
3. 服务器把 CA 数字证书（包含公钥）响应给客户端
4. 客户端解析证书拿到公钥，生成随机的 KEY
5. 客户端把解密后的 KEY 传递给服务端，使用随机码 KEY 对传输数据进行对称加密
6. 服务端拿私钥解密随机码 KEY，使用随机码 KEY 对传输的数据进行对称加密
7. 把对称加密后的内容传递给客户端，客户端使用之前生成的随机 KEY 进行解密数据

### 中间人攻击的过程

- 客户端请求被劫持，将所有的请求发送到中间人的服务器
- 中间人服务器返回自己的证书
- 客户端创建随机数，使用中间人证书中的公钥进行加密发送给中间人服务器，中间人使用私钥对随机数解密并构造对称加密，对之后传输的内容进行加密传输
- 中间人通过客户端的随机数对客户端的数据进行解密
- 中间人与服务端建立合法的 https 连接，和服务端之之间使用对称加密进行数据传输，拿到服务端的响应数据，并通过和服务器建立的对称加密的密钥进行解密
- 中间人再通过和客户端建立的对称加密对响应数据进行加密后传输给客户端
- 客户端通过与中间人建立的对称加密的密钥对数据进行解密

简单来说，中间人攻击中，中间人首先伪装成服务端和客户端进行通信，然后又伪装成客户端和服务端进行通信，整个过程中，由于缺少了证书的验证过程，虽然使用了 https，但是传输的数据已经被监听，客户端却无法得知。

### 怎么预防中间人攻击？

使用正规厂商的证书，慎用免费的
